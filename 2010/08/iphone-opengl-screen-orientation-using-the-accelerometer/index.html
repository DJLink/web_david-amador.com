<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>iPhone OpenGL screen orientation using the accelerometer | David Amador</title>
<meta name=keywords content="iphonedev,opengl"><meta name=description content="Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.
Let’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.
I’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this."><meta name=author content="David Amador"><link rel=canonical href=https://djlink.github.io/web_david-amador.com/2010/08/iphone-opengl-screen-orientation-using-the-accelerometer/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/web_david-amador.com/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="iPhone OpenGL screen orientation using the accelerometer"><meta property="og:description" content="Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.
Let’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.
I’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this."><meta property="og:type" content="article"><meta property="og:url" content="https://djlink.github.io/web_david-amador.com/2010/08/iphone-opengl-screen-orientation-using-the-accelerometer/"><meta property="og:image" content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-08-27T14:49:39+00:00"><meta property="article:modified_time" content="2010-08-27T14:49:39+00:00"><meta property="og:site_name" content="David Amador"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="iPhone OpenGL screen orientation using the accelerometer"><meta name=twitter:description content="Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.
Let’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.
I’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://djlink.github.io/web_david-amador.com/posts/"},{"@type":"ListItem","position":2,"name":"iPhone OpenGL screen orientation using the accelerometer","item":"https://djlink.github.io/web_david-amador.com/2010/08/iphone-opengl-screen-orientation-using-the-accelerometer/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"iPhone OpenGL screen orientation using the accelerometer","name":"iPhone OpenGL screen orientation using the accelerometer","description":"Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.\nLet’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.\nI’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this.","keywords":["iphonedev","opengl"],"articleBody":"Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.\nLet’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.\nI’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this.\nSo for Landscape with Home button on the right\nIt’s something like:\nglPushMatrix(); // Push a matrix to the stack glRotatef(90.0f, 0.0f, 0.0f, 1.0f); // Rotate 90 degrees glTranslatef(0.0f, -320, 0.0f); // Move vertically the screen Width /// Draw Stuff glPopMatrix(); So basically we are drawing all in a regular direction but rotating everything 90 degrees and translating to fit the screen properly.\nFor the home button on the left\nglPushMatrix(); glRotatef(-90.0f, 0.0f, 0.0f, 1.0f); glTranslatef(-480, 0.0f, 0.0f); // Move horizontally the screen Height // Draw Stuff glPopMatrix(); These are the tricky ones, you can figure out the Portrait Upside down =)\nOh, I’ve hard-coded the values (480 and 320) but you should make this a variable to support higher resolutions, iPhone 4 and iPad for instance.\nAlthough you could use iOS api to auto rotate this automatically I’ve read on numerous places that it’s slows down everything a bit and doing this on OpenGL is pretty quick and clean and if you ever port your game to another device (Android, etc) you don’t have to care about this again.\nSo now for the tricky part, to detect the device current orientation, the accelerometer can help out pretty good. We can check for the current angle to calculate where the device is pointing.\n- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration { // Get the current device angle float x = [acceleration x]; float y = [acceleration y]; float angle = atan2(y, x); if(angle \u003e= -2.25 \u0026\u0026 angle \u003c= -0.25) { /// Orientation is regular Portrait } else if(angle \u003e= -1.75 \u0026\u0026 angle \u003c= 0.75) { /// Orientation is Landscape with Home Button on the Left } else if(angle \u003e= 0.75 \u0026\u0026 angle \u003c= 2.25) { /// Orientation is Portrait flipped upside down } else if(angle \u003c= -2.25 || angle \u003e= 2.25) { /// Orientation is Landscape with Home Button on the Right } } So what you should do is keep a variable that stores the current Orientation so when you draw you know exactly what rotation to apply to the matrix.\nI’ve tested this code on a real device with pretty good results. Also it won’t slow down everything and if you think it does just check screen orientation at greater intervals.\nSome cool things you can do it when switching to iterate the rotation angle, that way you can simulate the screen rotation same way iOS does. Also you may want to put some sort of delay when switching.\nHere’s the result\n","wordCount":"504","inLanguage":"en","datePublished":"2010-08-27T14:49:39Z","dateModified":"2010-08-27T14:49:39Z","author":{"@type":"Person","name":"David Amador"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://djlink.github.io/web_david-amador.com/2010/08/iphone-opengl-screen-orientation-using-the-accelerometer/"},"publisher":{"@type":"Organization","name":"David Amador","logo":{"@type":"ImageObject","url":"https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://djlink.github.io/web_david-amador.com/ accesskey=h title="David Amador (Alt + H)"><img src=https://djlink.github.io/apple-touch-icon.png alt aria-label=logo height=35>David Amador</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://djlink.github.io/web_david-amador.com/ title=Blog><span>Blog</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/games/ title=Games><span>Games</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/portfolio/ title=Portfolio><span>Portfolio</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/about/ title="About Me"><span>About Me</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://djlink.github.io/web_david-amador.com/>Home</a>&nbsp;»&nbsp;<a href=https://djlink.github.io/web_david-amador.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">iPhone OpenGL screen orientation using the accelerometer</h1><div class=post-meta><span title='2010-08-27 14:49:39 +0000 UTC'>August 27, 2010</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;504 words&nbsp;·&nbsp;David Amador&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2010-08-27-iphone-opengl-screen-orientation-using-the-accelerometer.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Even tough it’s not mandatory to support all screen orientations it’s always nice to support at least 2 of them.</p><p>Let’s imagine your game is landscaped, by some reason the user may want to use either with the home button on the left or on the right. Most games support this, if you flip the device, the game will too.</p><p>I’ve been using OpenGL to support the device orientation, most people on forums want an automatic solution, but belive me, it’s best that you have control on this.</p><p>So for Landscape with Home button on the right</p><p><img loading=lazy src=/wp-content/uploads/2010/08/iphone_portrait_homebutton_right.png alt title=iphone_portrait_homebutton_right></p><p>It’s something like:</p><pre tabindex=0><code>&lt;pre lang=&#34;cpp&#34;&gt; glPushMatrix();   // Push a matrix to the stack
 glRotatef(90.0f, 0.0f, 0.0f, 1.0f); // Rotate 90 degrees
 glTranslatef(0.0f, -320, 0.0f);  // Move vertically the screen Width

 /// Draw Stuff

 glPopMatrix();
</code></pre><p>So basically we are drawing all in a regular direction but rotating everything 90 degrees and translating to fit the screen properly.</p><p>For the home button on the left</p><p><img loading=lazy src=/wp-content/uploads/2010/08/iphone_portrait_homebutton_left.png alt title=iphone_portrait_homebutton_left></p><pre tabindex=0><code>&lt;pre lang=&#34;cpp&#34;&gt;glPushMatrix();
glRotatef(-90.0f, 0.0f, 0.0f, 1.0f);
glTranslatef(-480, 0.0f, 0.0f); // Move horizontally the screen Height

// Draw Stuff

glPopMatrix();
</code></pre><p>These are the tricky ones, you can figure out the Portrait Upside down =)<br>Oh, I’ve hard-coded the values (480 and 320) but you should make this a variable to support higher resolutions, iPhone 4 and iPad for instance.</p><p>Although you could use iOS api to auto rotate this automatically I’ve read on numerous places that it’s slows down everything a bit and doing this on OpenGL is pretty quick and clean and if you ever port your game to another device (Android, etc) you don’t have to care about this again.</p><p>So now for the tricky part, to detect the device current orientation, the accelerometer can help out pretty good. We can check for the current angle to calculate where the device is pointing.</p><p><a href=/wp-content/uploads/2010/08/iphone_angles_orientation.png><img loading=lazy src=/wp-content/uploads/2010/08/iphone_angles_orientation-300x225.png alt title=iphone_angles_orientation></a></p><pre tabindex=0><code>&lt;pre lang=&#34;cpp&#34;&gt;- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration
 {
	// Get the current device angle
	float x = [acceleration x];
	float y = [acceleration y];
	float angle = atan2(y, x); 

        if(angle &gt;= -2.25 &amp;&amp; angle &lt;= -0.25)
	{
	/// Orientation is regular Portrait
	}
	else if(angle &gt;= -1.75 &amp;&amp; angle &lt;= 0.75)
	{
	/// Orientation is Landscape with Home Button on the Left
	}
	else if(angle &gt;= 0.75 &amp;&amp; angle &lt;= 2.25)
	{
	/// Orientation is Portrait flipped upside down
	}
	else if(angle &lt;= -2.25 || angle &gt;= 2.25)
	{
	/// Orientation is Landscape with Home Button on the Right
	}
}
</code></pre><p>So what you should do is keep a variable that stores the current Orientation so when you draw you know exactly what rotation to apply to the matrix.</p><p>I’ve tested this code on a real device with pretty good results. Also it won’t slow down everything and if you think it does just check screen orientation at greater intervals.</p><p>Some cool things you can do it when switching to iterate the rotation angle, that way you can simulate the screen rotation same way iOS does. Also you may want to put some sort of delay when switching.</p><p>Here’s the result</p><p></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://djlink.github.io/web_david-amador.com/tags/iphonedev/>iphonedev</a></li><li><a href=https://djlink.github.io/web_david-amador.com/tags/opengl/>opengl</a></li></ul><nav class=paginav><a class=prev href=https://djlink.github.io/web_david-amador.com/2010/09/targetting-ios-devices-hardware/><span class=title>« Prev</span><br><span>Targetting iOS devices hardware</span>
</a><a class=next href=https://djlink.github.io/web_david-amador.com/2010/08/developers-log-stardate-26082010/><span class=title>Next »</span><br><span>Developers log stardate 26082010</span></a></nav></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//upfallstudios.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://djlink.github.io/web_david-amador.com/>David Amador</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>