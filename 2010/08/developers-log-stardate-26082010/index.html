<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Developers log stardate 26082010 | David Amador</title>
<meta name="keywords" content="c&#43;&#43;, Iphone, iphonedev, opengl">
<meta name="description" content="It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.
Ever since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.
Here’s a picture she took after a few adjustments.">
<meta name="author" content="David Amador">
<link rel="canonical" href="https://www.david-amador.com/2010/08/developers-log-stardate-26082010/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.418159120d7fc526e2af8eb6e83c62edaee5397b34373faeb08618ce0c4f815d.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.david-amador.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.david-amador.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.david-amador.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.david-amador.com/david-amador-pixel.png">
<link rel="mask-icon" href="https://www.david-amador.com/david-amador-pixel.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.david-amador.com/2010/08/developers-log-stardate-26082010/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><script defer src="https://eu.umami.is/script.js" data-website-id="8dd501c4-c632-4f5b-8bc9-8d339e3e26ed"></script>
<meta property="og:url" content="https://www.david-amador.com/2010/08/developers-log-stardate-26082010/">
  <meta property="og:site_name" content="David Amador">
  <meta property="og:title" content="Developers log stardate 26082010">
  <meta property="og:description" content="It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.
Ever since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.
Here’s a picture she took after a few adjustments.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2010-08-26T19:05:55+00:00">
    <meta property="article:modified_time" content="2010-08-26T19:05:55+00:00">
    <meta property="article:tag" content="C&#43;&#43;">
    <meta property="article:tag" content="Iphone">
    <meta property="article:tag" content="Iphonedev">
    <meta property="article:tag" content="Opengl">
    <meta property="og:image" content="http://media.indiedb.com/cache/images/games/1/13/12804/thumb_620x2000/vizati_iphone.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://media.indiedb.com/cache/images/games/1/13/12804/thumb_620x2000/vizati_iphone.jpg">
<meta name="twitter:title" content="Developers log stardate 26082010">
<meta name="twitter:description" content="It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.
Ever since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.
Here’s a picture she took after a few adjustments.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.david-amador.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Developers log stardate 26082010",
      "item": "https://www.david-amador.com/2010/08/developers-log-stardate-26082010/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Developers log stardate 26082010",
  "name": "Developers log stardate 26082010",
  "description": "It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.\nEver since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.\nHere’s a picture she took after a few adjustments.\n",
  "keywords": [
    "c++", "Iphone", "iphonedev", "opengl"
  ],
  "articleBody": "It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.\nEver since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.\nHere’s a picture she took after a few adjustments.\nInitial testing\nFirst thing I notice when testing on the device were slowdowns when the cube is fading, it had a lot of particles filling the screen and the framerate dropped down, although this only happens when each level loads and doesn’t interfere with gameplay itself I got a little frustrated.\nOn the simulator It slowed down a little but only on Debug and even more OpenGL on the emulator is by software.\nAnother issue was the sound, I’m using OpenAL + a custom OGG parser, and sound was also slow, with hiccups.\nSound\nFor the sound it turned out a little easier than I expected, there as nothing wrong with the parser, what would happen is that if the CPU would sometimes take longer than expected on someplace and the player would run out of data making those hiccups, since it was constantly running out of data and getting more.\nI increased the buffers size and numbers, so now I have 5 buffers with 65536 bytes each. Every time a buffer is parsed I read another one and queue it.\nSolved the problem immediately. Yesterday while playing the game (after 10-20m) the sound started having hiccups again, although the game was fine, so I may still have some flaw in there, must research it more.\nHere’s a video where of me playing with some particles:\nPrimitives\nI can get much more particles on screen now because my first attempt to draw primitives in OpenGLES was drawing Quads with an mapped texture. When I got that working I would just send vertex points and texture coordinates and iterate all objects I wanted to draw.\nWROONGGGGGGG…..\nAlthough this works you should always batch as much geometry (within limits of course) as you can to make it on as fewer draw calls as you can. On both OpenGL and DirectX draw calls are the slowest part.\nIt’s faster to draw 1000 triangles in one call than on 1 triangle per call. You get the point.\nSo I started by making a PrimitiveBatch, sort of what XNA has, I just pass along vertex points, texture coordinates, color refs etc.\nSince it’s 2D I try to group by texture and by Z. All primitives with same texture on the same Z position can be drawn at once. You can’t draw all with same texture regardless of the Z some elements may be occluded when it was not intended, basically because it will keep drawing on top of what you have, at least for the current Buffer.\nAfter this I got enough drawing boost to have the same amount of particles that the PC version, which is cool.\nSome tips\nAlthough I’m still kind of new at this all iPhone things I can give you a few tips, they work for everything but are particular handy on devices with lower CPU power.\nAvoid using std::list:end(), on big lists it carries an extra burden. If you don’t intend to add/remove anything from the list during the cycle just save that at first\nstd::list::iterator b = _mylist.begin(); std::list::iterator e = _mylist.end(); while(b!=e) { /// Do stuff ++b; } Avoid deleting stuff on loops. One example, I have a list where I stack stuff to be drawn on my PrimitiveBatch, typically when you start drawing you add everything, the lists keeps growing, you draw and then delete, and you go back to “start drawing” again. You can optimize this by never deleting and only creating on a need basis. Belize me it makes huge difference, and besides you will need to create that again so might as well not delete it and when starting over just update values. Small things like this may not be an issue on PC but on small devices every cycle counts. Most of this stuff you may already know but there are many who don’t. I’ll try to update this more often.\nSo now I’ll get back to my testing to see if we get to testing and later to the app store asap =)\nPS: I need iPhone/IPod Touch testers, drop me an email with your UDID if you are interested…\n",
  "wordCount" : "760",
  "inLanguage": "en",
  "image":"http://media.indiedb.com/cache/images/games/1/13/12804/thumb_620x2000/vizati_iphone.jpg","datePublished": "2010-08-26T19:05:55Z",
  "dateModified": "2010-08-26T19:05:55Z",
  "author":{
    "@type": "Person",
    "name": "David Amador"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.david-amador.com/2010/08/developers-log-stardate-26082010/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "David Amador",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.david-amador.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.david-amador.com/" accesskey="h" title="David Amador (Alt + H)">
                <img src="https://www.david-amador.com/david-amador-pixel.png" alt="" aria-label="logo"
                    height="35">David Amador</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.david-amador.com/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://www.david-amador.com/games/" title="Games">
                    <span>Games</span>
                </a>
            </li>
            <li>
                <a href="https://www.david-amador.com/portfolio/" title="Portfolio">
                    <span>Portfolio</span>
                </a>
            </li>
            <li>
                <a href="https://www.david-amador.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://www.david-amador.com/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://www.david-amador.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.david-amador.com/">Home</a>&nbsp;»&nbsp;<a href="https://www.david-amador.com/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Developers log stardate 26082010
    </h1>
    <div class="post-meta"><span title='2010-08-26 19:05:55 +0000 UTC'>August 26, 2010</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;760 words&nbsp;·&nbsp;David Amador

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="http://media.indiedb.com/cache/images/games/1/13/12804/thumb_620x2000/vizati_iphone.jpg" alt="">
        
</figure>
  <div class="post-content"><p>It’s been awhile since I last updated this, I’ve have my hands full with Vizati iPhone.</p>
<p>Ever since I got an IPod Touch 2G it was easier for Rita to get a sense of the screen size (although we knew to be 320×480) it’s different when you are testing on the real thing, text looks smaller, other stuff looks way too big.</p>
<p>Here’s a picture she took after a few adjustments.</p>
<p><a href="http://www.indiedb.com/games/vizati/images/vizati-iphone" title="Vizati iPhone - Indie DB"><img alt="Vizati iPhone" loading="lazy" src="http://media.indiedb.com/cache/images/games/1/13/12804/thumb_620x2000/vizati_iphone.jpg"></a></p>
<p><strong>Initial testing</strong></p>
<p>First thing I notice when testing on the device were slowdowns when the cube is fading, it had a lot of particles filling the screen and the framerate dropped down, although this only happens when each level loads and doesn’t interfere with gameplay itself I got a little frustrated.<br>
On the simulator It slowed down a little but only on Debug and even more OpenGL on the emulator is by software.<br>
Another issue was the sound, I’m using OpenAL + a custom OGG parser, and sound was also slow, with hiccups.</p>
<p><strong>Sound</strong><br>
For the sound it turned out a little easier than I expected, there as nothing wrong with the parser, what would happen is that if the CPU would sometimes take longer than expected on someplace and the player would run out of data making those hiccups, since it was constantly running out of data and getting more.<br>
I increased the buffers size and numbers, so now I have 5 buffers with 65536 bytes each. Every time a buffer is parsed I read another one and queue it.<br>
Solved the problem immediately. Yesterday while playing the game (after 10-20m) the sound started having hiccups again, although the game was fine, so I may still have some flaw in there, must research it more.</p>
<p>Here’s a video where of me playing with some particles:</p>


    
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/ch3QvoBd1_c?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
      ></iframe>
    </div>

<p><strong>Primitives</strong><br>
I can get much more particles on screen now because my first attempt to draw primitives in OpenGLES was drawing Quads with an mapped texture. When I got that working I would just send vertex points and texture coordinates and iterate all objects I wanted to draw.<br>
WROONGGGGGGG…..<br>
Although this works you should always batch as much geometry (within limits of course) as you can to make it on as fewer draw calls as you can. On both OpenGL and DirectX draw calls are the slowest part.<br>
It’s faster to draw 1000 triangles in one call than on 1 triangle per call. You get the point.<br>
So I started by making a PrimitiveBatch, sort of what XNA has, I just pass along vertex points, texture coordinates, color refs etc.<br>
Since it’s 2D I try to group by texture and by Z. All primitives with same texture on the same Z position can be drawn at once. You can’t draw all with same texture regardless of the Z some elements may be occluded when it was not intended, basically because it will keep drawing on top of what you have, at least for the current Buffer.</p>
<p>After this I got enough drawing boost to have the same amount of particles that the PC version, which is cool.</p>
<p><strong>Some tips</strong><br>
Although I’m still kind of new at this all iPhone things I can give you a few tips, they work for everything but are particular handy on devices with lower CPU power.</p>
<ul>
<li>Avoid using std::list:end(), on big lists it carries an extra burden.</li>
</ul>
<p>If you don’t intend to add/remove anything from the list during the cycle just save that at first</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">   <span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">::</span><span class="n">iterator</span> <span class="n">b</span> <span class="o">=</span> <span class="n">_mylist</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">::</span><span class="n">iterator</span> <span class="n">e</span> <span class="o">=</span> <span class="n">_mylist</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span><span class="p">(</span><span class="n">b</span><span class="o">!=</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="c1">/// Do stuff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="o">++</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><ul>
<li>Avoid deleting stuff on loops. One example, I have a list where I stack stuff to be drawn on my PrimitiveBatch, typically when you start drawing you add everything, the lists keeps growing, you draw and then delete, and you go back to “start drawing” again. You can optimize this by never deleting and only creating on a need basis. Belize me it makes huge difference, and besides you will need to create that again so might as well not delete it and when starting over just update values. Small things like this may not be an issue on PC but on small devices every cycle counts.</li>
</ul>
<p>Most of this stuff you may already know but there are many who don’t. I’ll try to update this more often.</p>
<p>So now I’ll get back to my testing to see if we get to testing and later to the app store asap =)</p>
<p>PS: I need iPhone/IPod Touch testers, drop me an email with your UDID if you are interested…</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.david-amador.com/tags/c&#43;&#43;/">C&#43;&#43;</a></li>
      <li><a href="https://www.david-amador.com/tags/iphone/">Iphone</a></li>
      <li><a href="https://www.david-amador.com/tags/iphonedev/">Iphonedev</a></li>
      <li><a href="https://www.david-amador.com/tags/opengl/">Opengl</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.david-amador.com/2010/08/iphone-opengl-screen-orientation-using-the-accelerometer/">
    <span class="title">« Prev</span>
    <br>
    <span>iPhone OpenGL screen orientation using the accelerometer</span>
  </a>
  <a class="next" href="https://www.david-amador.com/2010/08/vizati-is-50-off-during-this-week/">
    <span class="title">Next »</span>
    <br>
    <span>Vizati is 50% off during this week</span>
  </a>
</nav>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "upfallstudios" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://www.david-amador.com/">David Amador</a></span>
	
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
