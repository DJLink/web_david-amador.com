<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fixing dark borders sprites on iPhone | David Amador</title>
<meta name=keywords content="Basalt,iPad,Iphone,XCode"><meta name=description content="I ran into this issue a couple hours ago working on the iPhone sdk:
See the darker borders around the image?
It’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?
Well that’s because that alpha isn’t 0 or 1 or 0 or 255.
The first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha."><meta name=author content="David Amador"><link rel=canonical href=https://djlink.github.io/web_david-amador.com/2010/07/fixing-dark-borders-sprites-on-iphone/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/web_david-amador.com/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Fixing dark borders sprites on iPhone"><meta property="og:description" content="I ran into this issue a couple hours ago working on the iPhone sdk:
See the darker borders around the image?
It’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?
Well that’s because that alpha isn’t 0 or 1 or 0 or 255.
The first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha."><meta property="og:type" content="article"><meta property="og:url" content="https://djlink.github.io/web_david-amador.com/2010/07/fixing-dark-borders-sprites-on-iphone/"><meta property="og:image" content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-07-26T12:47:01+00:00"><meta property="article:modified_time" content="2010-07-26T12:47:01+00:00"><meta property="og:site_name" content="David Amador"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Fixing dark borders sprites on iPhone"><meta name=twitter:description content="I ran into this issue a couple hours ago working on the iPhone sdk:
See the darker borders around the image?
It’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?
Well that’s because that alpha isn’t 0 or 1 or 0 or 255.
The first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://djlink.github.io/web_david-amador.com/posts/"},{"@type":"ListItem","position":2,"name":"Fixing dark borders sprites on iPhone","item":"https://djlink.github.io/web_david-amador.com/2010/07/fixing-dark-borders-sprites-on-iphone/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fixing dark borders sprites on iPhone","name":"Fixing dark borders sprites on iPhone","description":"I ran into this issue a couple hours ago working on the iPhone sdk:\nSee the darker borders around the image?\nIt’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?\nWell that’s because that alpha isn’t 0 or 1 or 0 or 255.\nThe first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha.","keywords":["Basalt","iPad","Iphone","XCode"],"articleBody":"I ran into this issue a couple hours ago working on the iPhone sdk:\nSee the darker borders around the image?\nIt’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?\nWell that’s because that alpha isn’t 0 or 1 or 0 or 255.\nThe first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha. So you can understand now why only 0 or 1 works right? Everything in between get’s changed. This is why Apple recommends using PNG over JPGS, although they consume more space they are altered for speed.\nThis is refereed as using images with pre-multiplied alpha.\nIf you don’t care about this and just want to use regular alpha blend one quick fix up for this is on each image load to reset the correct RGB values and maintain the A component\nint pixelcount = width*height; // Image data is a pointer for your image data int count = width*height; unsigned char* off = (unsigned char*)imageData; for( int i=0; i There may be other solutions but this won't have any impact on the game, just when loading images. Let me know if you find any other solution.\nEDIT: Quick note here: this is not the correct way to deal with pre-multiplied alpha but a patching. XNA recently embraced pre multiplied alpha to avoid this issues. More here (Thanks Elisée Maurer)\n","wordCount":"272","inLanguage":"en","datePublished":"2010-07-26T12:47:01Z","dateModified":"2010-07-26T12:47:01Z","author":{"@type":"Person","name":"David Amador"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://djlink.github.io/web_david-amador.com/2010/07/fixing-dark-borders-sprites-on-iphone/"},"publisher":{"@type":"Organization","name":"David Amador","logo":{"@type":"ImageObject","url":"https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://djlink.github.io/web_david-amador.com/ accesskey=h title="David Amador (Alt + H)"><img src=https://djlink.github.io/apple-touch-icon.png alt aria-label=logo height=35>David Amador</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://djlink.github.io/web_david-amador.com/ title=Blog><span>Blog</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/games/ title=Games><span>Games</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/portfolio/ title=Portfolio><span>Portfolio</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/about/ title="About Me"><span>About Me</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://djlink.github.io/web_david-amador.com/>Home</a>&nbsp;»&nbsp;<a href=https://djlink.github.io/web_david-amador.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Fixing dark borders sprites on iPhone</h1><div class=post-meta><span title='2010-07-26 12:47:01 +0000 UTC'>July 26, 2010</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;272 words&nbsp;·&nbsp;David Amador&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2010-07-26-fixing-dark-borders-sprites-on-iphone.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>I ran into this issue a couple hours ago working on the iPhone sdk:</p><p><img loading=lazy src=/wp-content/uploads/2010/07/iphone_image_dark_borders.png alt title=iphone_image_dark_borders>
<img loading=lazy src=/wp-content/uploads/2010/07/iphone_image_dark_borders_2.png alt title=iphone_image_dark_borders_2></p><p>See the darker borders around the image?</p><p>It’s a png image and that’s was supposed to be a gradient of alpha. So why am I getting this strange stuff around it?<br>Well that’s because that alpha isn’t 0 or 1 or 0 or 255.</p><p>The first thing I found out is that XCode grabs the png images and multiplies the RGB component with the alpha. So you can understand now why only 0 or 1 works right? Everything in between get’s changed. This is why Apple recommends using PNG over JPGS, although they consume more space they are altered for speed.</p><p>This is refereed as using images with <a href=http://en.wikipedia.org/wiki/User:Lkesteloot/premultiplied_alpha>pre-multiplied alpha</a>.</p><p>If you don’t care about this and just want to use regular alpha blend one quick fix up for this is on each image load to reset the correct RGB values and maintain the A component</p><pre tabindex=0><code>&lt;pre lang=&#34;cpp&#34;&gt; int pixelcount = width*height;
 // Image data is a pointer for your image data
  int count = width*height;
  unsigned char* off = (unsigned char*)imageData;

  for( int i=0; i 
&lt;p&gt;&lt;img alt=&#34;&#34; class=&#34;alignnone size-full wp-image-996&#34; decoding=&#34;async&#34; height=&#34;263&#34; loading=&#34;lazy&#34; src=&#34;/wp-content/uploads/2010/07/iphone_image_fixed_border.png&#34; title=&#34;iphone_image_fixed_border&#34; width=&#34;283&#34;&gt;&lt;/img&gt;&lt;img alt=&#34;&#34; class=&#34;alignnone size-full wp-image-995&#34; decoding=&#34;async&#34; height=&#34;234&#34; loading=&#34;lazy&#34; src=&#34;/wp-content/uploads/2010/07/iphone_image_border_fixed2.png&#34; title=&#34;iphone_image_border_fixed2&#34; width=&#34;262&#34;&gt;&lt;/img&gt;&lt;/p&gt;
&lt;p&gt;There may be other solutions but this won&#39;t have any impact on the game, just when loading images. Let me know if you find any other solution.&lt;/p&gt;
&lt;p&gt;EDIT: Quick note here: this is not the correct way to deal with pre-multiplied alpha but a patching. XNA recently embraced pre multiplied alpha to avoid this issues. More &lt;a href=&#34;http://blogs.msdn.com/b/shawnhar/archive/2009/11/06/premultiplied-alpha.aspx&#34;&gt;here&lt;/a&gt;  (Thanks Elisée Maurer)&lt;/p&gt;
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://djlink.github.io/web_david-amador.com/tags/basalt/>Basalt</a></li><li><a href=https://djlink.github.io/web_david-amador.com/tags/ipad/>iPad</a></li><li><a href=https://djlink.github.io/web_david-amador.com/tags/iphone/>Iphone</a></li><li><a href=https://djlink.github.io/web_david-amador.com/tags/xcode/>XCode</a></li></ul><nav class=paginav><a class=prev href=https://djlink.github.io/web_david-amador.com/2010/07/what-are-your-target-platforms-for-games/><span class=title>« Prev</span><br><span>What are your target platforms for games?</span>
</a><a class=next href=https://djlink.github.io/web_david-amador.com/2010/07/instance-based-callbacks-in-cpp/><span class=title>Next »</span><br><span>Instance based Callbacks in C++</span></a></nav></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//upfallstudios.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://djlink.github.io/web_david-amador.com/>David Amador</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>