<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A good Reference system can help your game | David Amador</title>
<meta name=keywords content="csharp"><meta name=description content="How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.
Now you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in."><meta name=author content="David Amador"><link rel=canonical href=https://djlink.github.io/web_david-amador.com/2010/06/a-good-reference-system-can-help-your-game/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/web_david-amador.com/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="A good Reference system can help your game"><meta property="og:description" content="How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.
Now you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in."><meta property="og:type" content="article"><meta property="og:url" content="https://djlink.github.io/web_david-amador.com/2010/06/a-good-reference-system-can-help-your-game/"><meta property="og:image" content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-06-06T09:49:36+00:00"><meta property="article:modified_time" content="2010-06-06T09:49:36+00:00"><meta property="og:site_name" content="David Amador"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://djlink.github.io/web_david-amador.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="A good Reference system can help your game"><meta name=twitter:description content="How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.
Now you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://djlink.github.io/web_david-amador.com/posts/"},{"@type":"ListItem","position":2,"name":"A good Reference system can help your game","item":"https://djlink.github.io/web_david-amador.com/2010/06/a-good-reference-system-can-help-your-game/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A good Reference system can help your game","name":"A good Reference system can help your game","description":"How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.\nNow you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in.","keywords":["csharp"],"articleBody":"How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.\nNow you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in. Deleting and removing from the list is a way, but why should you inside the spaceship class have know how to remove from the Scene list? Makes no sense. The list should know how to treat a deleted object.\nI made a somewhat satisfactory solution.\nA base class called Reference\npublic class Reference { protected string _name = \"\"; protected bool _notifying = false; protected List _to_alert_of_death = new List(); public Reference() { Name = \"UnknownReference\"; } public string Name { get { return _name; } set { _name = value; } } public void add_reference(Reference to_alert) { _to_alert_of_death.Add(to_alert); } public void remove_reference(Reference to_alert) { _to_alert_of_death.Remove(to_alert); } public void NotifyDeathToChilds() { // Prevents stack overflow if double reference exists if (_notifying) return; // Reference will be erase, notify children of death _notifying = true; for (int i = 0; i \u003c _to_alert_of_death.Count; ++i) { _to_alert_of_death[i].notify_death(this); } _to_alert_of_death.Clear(); _notifying = false; } public virtual void DeleteThis() { NotifyDeathToChilds(); } public virtual void notify_death(Reference reference) { _to_alert_of_death.Remove(reference); } } So when you create your dependent spaceship objects you just do something like:\nSpaceship.add_reference(DepedentObject);\nWhen you want to delete SpaceShip just do SpaceShip.DeleteThis(); and it will warn all dependent object that it’s being deleted\nBut how will the Dependent Object be aware of this?\nMake it inherit from Reference and override notify_death()\npublic virtual void notify_death(Reference reference) { // Compare reference var with the pointer you have to spaceship if(reference == mySpaceshipPointer) { // This means the class is being deleted so either delete this one as well or just put // mySpaceshipPointer to null mySpaceshipPointer = null; } base.notify(reference); } On a list case you would remove that reference from the list.\nThis solution is obviously not the best but it turned out pretty great for my games. I don’t have to care how many dependence there are. I delete one and all objects will be warned. How they treat that warning is up to you.\n","wordCount":"410","inLanguage":"en","datePublished":"2010-06-06T09:49:36Z","dateModified":"2010-06-06T09:49:36Z","author":{"@type":"Person","name":"David Amador"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://djlink.github.io/web_david-amador.com/2010/06/a-good-reference-system-can-help-your-game/"},"publisher":{"@type":"Organization","name":"David Amador","logo":{"@type":"ImageObject","url":"https://djlink.github.io/web_david-amador.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://djlink.github.io/web_david-amador.com/ accesskey=h title="David Amador (Alt + H)"><img src=https://djlink.github.io/apple-touch-icon.png alt aria-label=logo height=35>David Amador</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://djlink.github.io/web_david-amador.com/ title=Blog><span>Blog</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/games/ title=Games><span>Games</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/portfolio/ title=Portfolio><span>Portfolio</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/about/ title="About Me"><span>About Me</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://djlink.github.io/web_david-amador.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://djlink.github.io/web_david-amador.com/>Home</a>&nbsp;»&nbsp;<a href=https://djlink.github.io/web_david-amador.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">A good Reference system can help your game</h1><div class=post-meta><span title='2010-06-06 09:49:36 +0000 UTC'>June 6, 2010</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;410 words&nbsp;·&nbsp;David Amador&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2010-06-06-a-good-reference-system-can-help-your-game.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>How many times has it happened where you have this one class, let’s say it’s a spaceship that was destroyed.</p><p>Now you have tell all other dependent objects that she died, any independent sprite animation class, AI, etc etc because they were relying on her. Another thing is, in my case, having a scene that contains all the objects and by deleting the ship It won’t get removed from the scene, keeping the reference alive and so Garbage collector won’t kick in. Deleting and removing from the list is a way, but why should you inside the spaceship class have know how to remove from the Scene list? Makes no sense. The list should know how to treat a deleted object.</p><p>I made a somewhat satisfactory solution.</p><p>A base class called Reference</p><pre tabindex=0><code>&lt;pre lang=&#34;csharp&#34;&gt;   public class Reference
    {
        protected string    _name = &#34;&#34;;
        protected bool      _notifying = false;
        protected   List _to_alert_of_death = new List();

        public Reference()
        {
            Name = &#34;UnknownReference&#34;;
        }

        public string Name
        {
            get { return _name; }
            set { _name = value; }
        }

        public void add_reference(Reference to_alert)
        {
            _to_alert_of_death.Add(to_alert);
        }

        public void remove_reference(Reference to_alert)
        {
            _to_alert_of_death.Remove(to_alert);
        }

        public void NotifyDeathToChilds()
        {
            // Prevents stack overflow if double reference exists
            if (_notifying) return;
            // Reference will be erase, notify children of death
            _notifying = true;
            for (int i = 0; i &lt; _to_alert_of_death.Count; ++i)
            {
                _to_alert_of_death[i].notify_death(this);
            }
            _to_alert_of_death.Clear();
            _notifying = false;
        }

        public virtual void DeleteThis()
        {
            NotifyDeathToChilds();
        }
        public virtual void notify_death(Reference reference)
        {
            _to_alert_of_death.Remove(reference);
        }
    }
</code></pre><p>So when you create your dependent spaceship objects you just do something like:</p><p>Spaceship.add_reference(DepedentObject);</p><p>When you want to delete SpaceShip just do SpaceShip.DeleteThis(); and it will warn all dependent object that it’s being deleted</p><p>But how will the Dependent Object be aware of this?<br>Make it inherit from Reference and override notify_death()</p><pre tabindex=0><code>&lt;pre lang=&#34;csharp&#34;&gt;        public virtual void notify_death(Reference reference)
        {
              // Compare reference var with the pointer you have to spaceship
              if(reference == mySpaceshipPointer)
             {
                // This means the class is being deleted so either delete this one as well or just put
               // mySpaceshipPointer to null
               mySpaceshipPointer = null;
             }
             base.notify(reference);
        }
</code></pre><p>On a list case you would remove that reference from the list.</p><p>This solution is obviously not the best but it turned out pretty great for my games. I don’t have to care how many dependence there are. I delete one and all objects will be warned. How they treat that warning is up to you.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://djlink.github.io/web_david-amador.com/tags/csharp/>csharp</a></li></ul><nav class=paginav><a class=prev href=https://djlink.github.io/web_david-amador.com/2010/06/who-wants-to-try-vizati-demo/><span class=title>« Prev</span><br><span>Who wants to try Vizati Demo?</span>
</a><a class=next href=https://djlink.github.io/web_david-amador.com/2010/05/yay-my-first-game-as-indie-developer-is-almost-out/><span class=title>Next »</span><br><span>Yay, my first Game as Indie Developer is almost out</span></a></nav></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//upfallstudios.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://djlink.github.io/web_david-amador.com/>David Amador</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>